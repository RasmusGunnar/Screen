<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SUBRA Workplace Arrival Portal</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
  <script
    defer
    src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"
    integrity="sha512-J7co8U8AwrKyEBkuuRsYwk1mGUZXoq+X0eZomPFcQyHfjzbIdtk1t7Ww5x0R6FK5j3QpNyITG8Jw3HgXwYv4sA=="
    crossorigin="anonymous"
  ></script>
  <script defer src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/9.22.2/firebase-storage-compat.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script defer src="firebase-config.js"></script>
  <script defer src="app.js"></script>
</head>
<body>
  <div id="app-container">
    <section id="screensaver" class="screensaver">
      <p class="screensaver-hint">Tryk for at starte registreringen</p>
    </section>

    <template id="screensaver-slide-template">
      <div class="slide">
        <div class="overlay overlay-top-left">
          <img src="assets/logo.svg" alt="SUBRA" class="logo" />
        </div>
        <div class="overlay overlay-bottom-center">
          <p class="welcome-tagline"></p>
          <p class="welcome-instruction"></p>
        </div>
      </div>
    </template>

    <main id="main-app" class="hidden">
      <header class="app-header">
        <div class="brand">
          <img src="assets/logo.svg" alt="SUBRA" class="logo" />
          <div class="brand-copy">
            <h1>SUBRA Workplace Arrival Portal</h1>
            <p class="subline">Oversigt over medarbejdere, gæster og tilstedeværelse</p>
          </div>
        </div>
        <div class="header-widgets">
          <div class="widget clock" id="live-clock"></div>
          <div class="widget weather">
            <p>København</p>
            <p class="temperature">19°C · Skyet</p>
          </div>
          <button id="admin-toggle" class="ghost-button">Admin &amp; sync</button>
        </div>
      </header>

      <section class="status-summary" id="status-summary">
        <div class="summary-card">
          <span class="summary-label">På kontoret</span>
          <span class="summary-value" data-summary="onsite">0</span>
        </div>
        <div class="summary-card">
          <span class="summary-label">Arbejde hjemmefra</span>
          <span class="summary-value" data-summary="remote">0</span>
        </div>
        <div class="summary-card">
          <span class="summary-label">Fravær</span>
          <span class="summary-value" data-summary="away">0</span>
        </div>
        <div class="summary-card">
          <span class="summary-label">Gæster registreret i dag</span>
          <span class="summary-value" data-summary="guests">0</span>
        </div>
      </section>

      <section class="interaction-panel">
        <div class="checkin-card">
          <h2>Registrer ankomst eller afgang</h2>
          <div class="input-row">
            <label for="employee-search">Søg medarbejder</label>
            <input type="search" id="employee-search" placeholder="Søg efter navn eller afdeling" />
          </div>
          <div class="quick-actions">
            <button class="primary" data-quick="checkin">Tjek alle ind (brandøvelse)</button>
            <button class="ghost" data-quick="checkout">Tøm bygningen</button>
            <button class="ghost" data-quick="rollcall">Evakueringsliste</button>
          </div>
        </div>
        <div class="guest-card">
          <h2>Registrering af gæster</h2>
          <form id="guest-form">
            <div class="form-group">
              <label for="guest-name">Navn</label>
              <input id="guest-name" required placeholder="Gæstens navn" />
            </div>
            <div class="form-group">
              <label for="guest-company">Virksomhed</label>
              <input id="guest-company" placeholder="Virksomhed (valgfrit)" />
            </div>
            <div class="form-group">
              <label for="guest-host">Besøger</label>
              <select id="guest-host" required></select>
            </div>
            <div class="form-group">
              <label for="guest-purpose">Formål</label>
              <input id="guest-purpose" placeholder="Møde, interview, leverance..." />
            </div>
            <fieldset class="form-group policy-checkboxes">
              <legend>Politikker</legend>
              <label class="checkbox">
                <input type="checkbox" id="guest-nda" required />
                Jeg har læst og accepterer SUBRAs NDA.
              </label>
              <label class="checkbox">
                <input type="checkbox" id="guest-it" required />
                Jeg accepterer retningslinjerne for IT- og datasikkerhed.
              </label>
            </fieldset>
            <button type="submit" class="primary">Registrer gæst</button>
            <p class="form-hint">Den valgte medarbejder får en notifikation (simuleret).</p>
          </form>
          <div class="guest-log" id="guest-log"></div>
        </div>
        <div class="self-service-card">
          <h2>Hurtig selvbetjening</h2>
          <p>Scan en QR-kode for at registrere dig fra din egen telefon.</p>
          <div class="qr-grid">
            <figure>
              <div id="employee-qr" class="qr-canvas" role="img" aria-label="QR-kode for medarbejdere"></div>
              <figcaption>
                Medarbejder check-ind/out
                <small id="employee-qr-link" class="qr-link"></small>
              </figcaption>
            </figure>
            <figure>
              <div id="guest-qr" class="qr-canvas" role="img" aria-label="QR-kode for gæster"></div>
              <figcaption>
                Gæsteregistrering
                <small id="guest-qr-link" class="qr-link"></small>
              </figcaption>
            </figure>
          </div>
          <p class="qr-hint">
            QR-koderne opdateres automatisk når du ændrer links i adminpanelet eller synkroniserer via Firebase.
          </p>
        </div>
      </section>

      <section class="departments" id="departments"></section>

      <section class="sync-section">
        <h2>Synkronisering og opdatering</h2>
        <p>
          Alle medarbejdere, gæster og slides gemmes automatisk i Firebase Firestore. Hvis flere kiosker peger på det
          samme dokument, ser de de samme data med det samme. Brug eksport/import herunder som backup eller til hurtig
          masseopdatering.
        </p>
        <div class="sync-actions">
          <button class="ghost" id="export-data">Eksporter data</button>
          <button class="ghost" id="import-data">Importer data</button>
          <input type="file" id="import-file" accept="application/json" hidden />
        </div>
        <pre class="sync-output" id="sync-output" aria-live="polite"></pre>
      </section>

      <section class="feature-highlight">
        <h2>Udvidelser inspireret af Swipedon</h2>
        <ul>
          <li>Digital log over alle check-ins/-outs og gæstebesøg med tidsstempel.</li>
          <li>Evakueringsliste i realtid til sikkerhed og compliance.</li>
          <li>NDA/IT-politik modal ved check-in for både medarbejdere og gæster.</li>
          <li>QR-koder til hurtig selvbetjening for medarbejdere og gæster.</li>
          <li>Integration til adgangskontrol eller notifikationssystemer (SMS/mail webhooks).</li>
        </ul>
      </section>

      <footer class="app-footer">
        <p>SUBRA · Workplace Arrival Portal · Designet til 16:9 vertikal skærm</p>
      </footer>
    </main>
  </div>

  <div id="status-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="modal-title">
    <div class="modal-content">
      <button class="modal-close" aria-label="Luk" id="modal-close">&times;</button>
      <h2 id="modal-title">Opdater status</h2>
      <form id="status-form">
        <p class="modal-employee" id="modal-employee"></p>
        <div class="form-group">
          <label for="status-type">Status</label>
          <select id="status-type">
            <option value="onsite">På kontoret</option>
            <option value="remote">Arbejder hjemme</option>
            <option value="away">Fravær (sygdom/barsel)</option>
          </select>
        </div>
        <div class="form-group">
          <label for="absence-from">Fravær fra</label>
          <input type="date" id="absence-from" />
        </div>
        <div class="form-group">
          <label for="absence-to">Fravær til</label>
          <input type="date" id="absence-to" />
        </div>
        <div class="form-group">
          <label for="status-notes">Noter</label>
          <textarea id="status-notes" rows="2" placeholder="F.eks. syg, barsel, ferie..."></textarea>
        </div>
        <button type="submit" class="primary">Gem</button>
      </form>
    </div>
  </div>

  <div
    id="policy-modal"
    class="modal hidden"
    role="dialog"
    aria-modal="true"
    aria-labelledby="policy-modal-title"
    aria-hidden="true"
  >
    <div class="modal-content policy-modal">
      <button class="modal-close" aria-label="Luk" id="policy-close">&times;</button>
      <h2 id="policy-modal-title">Bekræft politikker</h2>
      <p class="policy-intro">Før <span id="policy-employee"></span> kan tjekke ind, skal følgende politikker accepteres.</p>
      <form id="policy-form">
        <label class="checkbox">
          <input type="checkbox" id="policy-nda" required />
          Jeg har læst og accepteret SUBRAs fortroligheds- og NDA-politik.
        </label>
        <label class="checkbox">
          <input type="checkbox" id="policy-it" required />
          Jeg bekræfter, at jeg følger virksomhedens IT- og datasikkerhedspolitik.
        </label>
        <div class="policy-actions">
          <button type="button" class="ghost" id="policy-cancel">Annuller</button>
          <button type="submit" class="primary">Accepter &amp; tjek ind</button>
        </div>
      </form>
    </div>
  </div>

  <aside id="admin-drawer" class="drawer hidden" aria-hidden="true">
    <div class="drawer-header">
      <h2>Administration</h2>
      <button id="drawer-close" aria-label="Luk">&times;</button>
    </div>
    <section class="drawer-section">
      <h3>Medarbejdere</h3>
      <p>Tilføj, redigér eller fjern medarbejdere. Ændringer synkroniseres via eksport/import eller backend.</p>
      <form id="employee-form" class="drawer-form">
        <input type="hidden" id="employee-id" />
        <div class="form-grid">
          <label>Fornavn<input id="employee-first" required /></label>
          <label>Efternavn<input id="employee-last" required /></label>
          <label>Rolle<input id="employee-role" placeholder="Titel" /></label>
          <label>Afdeling<input id="employee-department" required /></label>
          <label>Kontakt<input id="employee-contact" placeholder="E-mail eller telefon" /></label>
          <label>Billede-URL<input id="employee-photo" placeholder="https://..." /></label>
        </div>
        <div class="drawer-actions">
          <button type="submit" class="primary">Gem medarbejder</button>
          <button type="button" class="ghost" id="reset-form">Nulstil</button>
        </div>
      </form>
      <div id="employee-list" class="drawer-list"></div>
    </section>
    <section class="drawer-section">
      <h3>Pauseskærm &amp; billedbank</h3>
      <p>
        Tilføj slides, redigér tekster og upload fotos direkte fra skærmen. Billederne gemmes i Firebase Storage under
        mappen <code>/screensaver</code>, så alle skærme deler den samme billedbank.
      </p>
      <div id="screensaver-admin" class="drawer-list"></div>
      <div class="drawer-actions">
        <button type="button" class="ghost" id="add-slide">Tilføj slide</button>
      </div>
      <input type="file" id="slide-upload" accept="image/*" hidden />
    </section>
    <section class="drawer-section">
      <h3>Sky-konfiguration</h3>
      <p>
        Appen læser dine Firebase-nøgler fra filen <code>firebase-config.js</code>. Tilpas filen med projektets
        <code>apiKey</code>, <code>projectId</code> osv. – herefter forbindes alle kiosker automatisk til det samme
        Firestore-dokument.
      </p>
      <ul class="drawer-info">
        <li><code>SUBRA_KIOSK_COLLECTION</code> og <code>SUBRA_KIOSK_DOCUMENT</code> kan sættes i filen for at dele eller opdele lokationer.</li>
        <li>Slides uploades til Storage og metadata gemmes i Firestore. Ændringer vises live på alle skærme.</li>
        <li>Tilføj evt. servicekonto eller backend-funktioner for SMS-notifikationer, gæsteadgang m.m.</li>
      </ul>
    </section>
    <section class="drawer-section">
      <h3>QR-selvbetjening</h3>
      <p>Angiv URL'er til mobilvenlige workflows. Koderne regenereres med det samme.</p>
      <form id="qr-form" class="drawer-form">
        <div class="form-grid">
          <label>Medarbejder-URL<input id="qr-employee" placeholder="https://" /></label>
          <label>Gæste-URL<input id="qr-guest" placeholder="https://" /></label>
        </div>
        <div class="drawer-actions">
          <button type="submit" class="primary">Opdater QR-koder</button>
        </div>
      </form>
    </section>
    <section class="drawer-section">
      <h3>Opsætning</h3>
      <ul class="drawer-info">
        <li>Slides uploades direkte til Firebase Storage og vises live på alle skærme.</li>
        <li>Medarbejderlisten vedligeholdes i Firestore – brug import/eksport for større ændringer.</li>
        <li>QR-links peger typisk mod mobilformularer eller apps til selvbetjening.</li>
        <li>Integrér mod SMS/e-mail ved at udvide funktionen <code>notifyHost</code>.</li>
      </ul>
    </section>
  </aside>
</body>
</html>
